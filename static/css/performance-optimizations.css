/* 性能优化 CSS - 专门针对关键人物卡片滑动卡顿问题 */

/* 1. 开启硬件加速 - 关键人物卡片区域 */
#personsContainer {
    /* GPU加速 */
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
    
    /* 优化滚动性能 */
    overflow-y: auto;
    will-change: scroll-position;
    
    /* 减少重绘 */
    contain: layout style paint;
    
    /* 平滑滚动 */
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
}

/* 2. 优化人物卡片渲染性能 */
.person-card {
    /* GPU加速 */
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
    
    /* 减少重排/重绘 */
    contain: layout style;
    
    /* 优化动画性能 */
    will-change: transform, opacity;
    
    /* 避免布局抖动 */
    min-height: auto;
    
    /* 优化边框渲染 */
    border: 1px solid var(--color-gray-200);
    border-radius: var(--radius-lg);
    
    /* 优化阴影渲染 */
    box-shadow: var(--shadow-sm);
    
    /* 过渡效果优化 */
    transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), 
                box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

/* 3. 优化人物卡片悬停效果 */
.person-card:hover {
    /* 使用transform而不是修改布局 */
    transform: translateY(-2px) translateZ(0);
    box-shadow: var(--shadow-lg);
}

/* 4. 优化表单元素性能 */
.person-card .form-control {
    /* 减少重排 */
    contain: layout;
    
    /* 优化输入性能 */
    will-change: border-color, box-shadow;
    
    /* 优化过渡 */
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}

/* 5. 优化复选框组性能 */
.checkbox-group {
    /* 使用flexbox优化布局 */
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    
    /* 减少重排 */
    contain: layout;
}

.checkbox-tag {
    /* GPU加速 */
    transform: translateZ(0);
    
    /* 减少重绘 */
    contain: layout style;
    
    /* 优化过渡 */
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

/* 6. 优化展开/收起动画 */
.needs-expandable-section {
    /* 使用transform而不是height动画 */
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    
    /* 优化动画性能 */
    will-change: transform, opacity;
    contain: layout;
}

.needs-expandable-section.collapsed {
    transform: translateY(-10px);
    opacity: 0;
    height: 0;
    overflow: hidden;
}

.needs-expandable-section.expanded {
    transform: translateY(0);
    opacity: 1;
    height: auto;
}

.needs-expandable-section.expanding {
    transform: translateY(-5px);
    opacity: 0.5;
}

.needs-expandable-section.collapsing {
    transform: translateY(-5px);
    opacity: 0.5;
}

/* 7. 优化滚动条样式（WebKit浏览器） */
#personsContainer::-webkit-scrollbar {
    width: 6px;
}

#personsContainer::-webkit-scrollbar-track {
    background: var(--color-gray-100);
    border-radius: 3px;
}

#personsContainer::-webkit-scrollbar-thumb {
    background: var(--color-gray-300);
    border-radius: 3px;
    transition: background-color 0.2s ease;
}

#personsContainer::-webkit-scrollbar-thumb:hover {
    background: var(--color-gray-400);
}

/* 8. 优化动态内容加载 */
.person-card-template {
    /* 隐藏模板 */
    display: none;
}

/* 9. 移动端优化 */
@media (max-width: 768px) {
    .person-card {
        /* 减少移动端复杂度 */
        will-change: auto;
        transform: none;
    }
    
    .person-card:hover {
        /* 移动端不需要悬停效果 */
        transform: none;
    }
    
    #personsContainer {
        /* 移动端滚动优化 */
        -webkit-overflow-scrolling: touch;
        overscroll-behavior: contain;
    }
}

/* 10. 减少重绘的工具类 */
.no-repaint {
    contain: layout style paint;
    will-change: transform;
}

.gpu-accelerated {
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
}

/* 11. 优化资源字段特殊处理 */
.resource-input-group {
    contain: layout;
    will-change: auto;
}

.resource-tag {
    contain: style;
    transform: translateZ(0);
}

/* 12. 批量操作优化 */
.batch-operation {
    /* 临时禁用动画 */
    transition: none !important;
    animation: none !important;
}

/* 13. 内存优化 - 限制同时显示的复杂动画 */
.person-card:nth-child(n+6) {
    /* 超过6个卡片时减少动画复杂度 */
    will-change: auto;
    transition: none;
}

.person-card:nth-child(n+6):hover {
    transform: none;
    box-shadow: var(--shadow-sm);
}