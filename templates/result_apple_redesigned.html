<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ”¶å…¥è·¯å¾„è®¾è®¡æ–¹æ¡ˆ - Angela AI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/apple-design-system.css') }}" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* Appleçº§åˆ«ç»“æœå±•ç¤ºé¡µé¢æ ·å¼ */
        :root {
            --page-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --glass-bg: rgba(255, 255, 255, 0.95);
            --glass-border: rgba(255, 255, 255, 0.2);
            --accent-gradient: linear-gradient(45deg, var(--color-primary), var(--color-secondary));
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
            background: var(--page-bg);
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        /* å¯¼èˆªæ æ ·å¼ */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 var(--space-6);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .navbar-left {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .back-btn {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-4);
            background: rgba(0, 122, 255, 0.1);
            color: var(--color-primary);
            text-decoration: none;
            border-radius: var(--radius-lg);
            font-weight: var(--font-medium);
            font-size: var(--text-sm);
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 122, 255, 0.2);
        }

        .back-btn:hover {
            background: rgba(0, 122, 255, 0.15);
            color: var(--color-primary-dark);
            text-decoration: none;
            transform: translateX(-2px);
        }

        .navbar-brand {
            font-size: var(--text-lg);
            font-weight: var(--font-bold);
            color: var(--color-text-primary);
            text-decoration: none;
        }

        .navbar-brand:hover {
            color: var(--color-primary);
            text-decoration: none;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .navbar-action {
            padding: var(--space-2) var(--space-3);
            background: transparent;
            border: 1px solid var(--color-gray-300);
            border-radius: var(--radius-lg);
            font-size: var(--text-sm);
            color: var(--color-text-secondary);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .navbar-action:hover {
            background: var(--color-gray-100);
            color: var(--color-text-primary);
            text-decoration: none;
        }

        /* ä¸ºä¸»å†…å®¹æ·»åŠ é¡¶éƒ¨é—´è·é¿å…è¢«å¯¼èˆªæ é®æŒ¡ */
        .result-page-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: calc(60px + var(--space-8)) var(--space-4) var(--space-8);
            min-height: 100vh;
        }

        /* ä¸»å®¹å™¨ - å·²ç§»åŠ¨åˆ°å¯¼èˆªæ æ ·å¼éƒ¨åˆ† */

        /* é¡µé¢å¤´éƒ¨ */
        .result-hero {
            text-align: center;
            margin-bottom: var(--space-12);
            padding: var(--space-8) 0;
        }

        .hero-badge {
            display: inline-flex;
            align-items: center;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-full);
            padding: var(--space-2) var(--space-4);
            margin-bottom: var(--space-4);
            backdrop-filter: blur(20px);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--color-primary);
        }

        .hero-title {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 700;
            color: white;
            margin-bottom: var(--space-3);
            line-height: 1.2;
            text-shadow: 0 2px 20px rgba(0, 0, 0, 0.2);
        }

        .hero-subtitle {
            font-size: var(--text-xl);
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: var(--space-8);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        /* å¡ç‰‡ç³»ç»Ÿ */
        .glass-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-2xl);
            padding: var(--space-8);
            margin-bottom: var(--space-6);
            backdrop-filter: blur(20px);
            box-shadow: var(--shadow-xl);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        /* æ¦‚è§ˆå¡ç‰‡ */
        .overview-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
        }

        .overview-title {
            display: flex;
            align-items: center;
            font-size: var(--text-2xl);
            font-weight: var(--font-bold);
            margin-bottom: var(--space-6);
            color: white;
        }

        .overview-title i {
            margin-right: var(--space-3);
            padding: var(--space-2);
            background: rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-lg);
        }

        .situation-text {
            font-size: var(--text-lg);
            line-height: 1.7;
            margin-bottom: var(--space-6);
            color: rgba(255, 255, 255, 0.95);
        }

        /* å·®è·æ ‡ç­¾ */
        .gaps-container {
            margin-bottom: var(--space-6);
        }

        .gaps-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            margin-bottom: var(--space-4);
            color: rgba(255, 255, 255, 0.9);
        }

        .gap-tags {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-3);
        }

        .gap-tag {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-full);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* è·¯å¾„å¡ç‰‡ */
        .path-card {
            position: relative;
            overflow: hidden;
        }

        .path-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-6);
        }

        .path-number {
            width: 48px;
            height: 48px;
            background: var(--accent-gradient);
            color: white;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: var(--font-bold);
            font-size: var(--text-lg);
        }

        .path-title {
            font-size: var(--text-2xl);
            font-weight: var(--font-bold);
            color: var(--color-text-primary);
            margin: 0;
            flex: 1;
            margin-left: var(--space-4);
        }

        .path-scene {
            background: var(--color-bg-secondary);
            color: var(--color-text-secondary);
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius-lg);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
        }

        /* è¡ŒåŠ¨æ­¥éª¤ */
        .action-steps {
            margin: var(--space-6) 0;
        }

        .step-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: var(--space-4);
            padding: var(--space-4);
            background: var(--color-bg-secondary);
            border-radius: var(--radius-lg);
            border-left: 4px solid var(--color-primary);
        }

        .step-owner {
            min-width: 80px;
            font-weight: var(--font-semibold);
            color: var(--color-primary);
            margin-right: var(--space-4);
        }

        .step-content {
            flex: 1;
        }

        .step-action {
            font-size: var(--text-base);
            color: var(--color-text-primary);
            margin-bottom: var(--space-2);
            line-height: 1.6;
        }

        .step-reason {
            font-size: var(--text-sm);
            color: var(--color-text-secondary);
            font-style: italic;
        }

        /* MVPåŒºåŸŸ */
        .mvp-section {
            background: linear-gradient(135deg, var(--color-success), #28a745);
            color: white;
            padding: var(--space-6);
            border-radius: var(--radius-xl);
            margin: var(--space-6) 0;
        }

        .mvp-title {
            display: flex;
            align-items: center;
            font-weight: var(--font-bold);
            margin-bottom: var(--space-3);
        }

        .mvp-title i {
            margin-right: var(--space-2);
        }

        /* èµ„æºå’Œé£é™© */
        .resources-risks {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-6);
            margin: var(--space-6) 0;
        }

        @media (max-width: 768px) {
            .resources-risks {
                grid-template-columns: 1fr;
            }
        }

        .info-section {
            padding: var(--space-4);
            border-radius: var(--radius-lg);
            border: 1px solid var(--color-gray-200);
        }

        .info-title {
            font-weight: var(--font-semibold);
            color: var(--color-text-primary);
            margin-bottom: var(--space-3);
        }

        .info-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .info-list li {
            padding: var(--space-2) 0;
            border-bottom: 1px solid var(--color-gray-100);
            color: var(--color-text-secondary);
        }

        .info-list li:last-child {
            border-bottom: none;
        }

        /* æ“ä½œæŒ‰é’® */
        .action-buttons {
            display: flex;
            gap: var(--space-4);
            justify-content: center;
            margin-top: var(--space-12);
            flex-wrap: wrap;
        }

        .action-btn {
            padding: var(--space-4) var(--space-8);
            border-radius: var(--radius-xl);
            font-weight: var(--font-semibold);
            text-decoration: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
        }

        .btn-primary-custom {
            background: var(--accent-gradient);
            color: white;
            border: none;
        }

        .btn-secondary-custom {
            background: var(--glass-bg);
            color: var(--color-primary);
            border: 1px solid var(--color-primary);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* åŠ¨ç”»æ•ˆæœ */
        .fade-in-up {
            animation: fadeInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-delay-1 { animation-delay: 0.1s; }
        .animate-delay-2 { animation-delay: 0.2s; }
        .animate-delay-3 { animation-delay: 0.3s; }
        .animate-delay-4 { animation-delay: 0.4s; }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .result-page-container {
                padding: calc(60px + var(--space-4)) var(--space-3) var(--space-4);
            }
            
            .navbar {
                padding: 0 var(--space-3);
            }
            
            .navbar-brand {
                font-size: var(--text-base);
            }
            
            .glass-card {
                padding: var(--space-6);
            }
            
            .path-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-4);
            }
            
            .path-title {
                margin-left: 0;
            }
        }

        /* åˆ†äº«æ¨¡æ€æ¡†æ ·å¼ */
        .share-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .share-overlay.show {
            opacity: 1;
        }

        .share-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-2xl);
            padding: var(--space-8);
            min-width: 400px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            backdrop-filter: blur(20px);
            z-index: 1001;
            display: none;
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .share-modal.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        .share-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-6);
            border-bottom: 1px solid var(--color-gray-200);
            padding-bottom: var(--space-4);
        }

        .share-title {
            font-size: var(--text-xl);
            font-weight: var(--font-bold);
            color: var(--color-text-primary);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: var(--text-xl);
            color: var(--color-text-secondary);
            cursor: pointer;
            padding: var(--space-2);
            border-radius: var(--radius-lg);
            transition: all 0.2s ease;
        }

        .close-btn:hover {
            background: var(--color-gray-100);
            color: var(--color-text-primary);
        }

        .share-options {
            display: grid;
            gap: var(--space-4);
        }

        .share-section {
            margin-bottom: var(--space-6);
        }

        .section-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--color-text-primary);
            margin-bottom: var(--space-4);
        }

        .copy-link-section {
            background: var(--color-bg-secondary);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
        }

        .copy-link-btn {
            width: 100%;
            background: var(--color-primary);
            color: white;
            border: none;
            border-radius: var(--radius-lg);
            padding: var(--space-3) var(--space-4);
            font-weight: var(--font-medium);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
        }

        .copy-link-btn:hover {
            background: var(--color-primary-dark);
            transform: translateY(-1px);
        }

        .social-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: var(--space-3);
        }

        .social-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: var(--space-4);
            border: 1px solid var(--color-gray-200);
            border-radius: var(--radius-lg);
            background: white;
            text-decoration: none;
            color: var(--color-text-primary);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .social-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--color-primary);
        }

        .social-icon {
            width: 32px;
            height: 32px;
            margin-bottom: var(--space-2);
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .wechat { color: #07C160; }
        .weibo { color: #E6162D; }
        .qq { color: #12B7F5; }
        .qzone { color: #FCCA03; }

        .wechat-qr {
            display: none;
            background: white;
            border-radius: var(--radius-lg);
            margin-top: var(--space-4);
        }

        /* éª¨æ¶å±æ ·å¼ */
        .skeleton-container {
            padding-top: 80px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .thinking-header {
            text-align: center;
            margin-bottom: var(--space-8);
            opacity: 0;
            animation: fadeInUp 1s ease-out forwards;
        }

        .ai-icon {
            font-size: 4rem;
            color: white;
            margin-bottom: var(--space-4);
            animation: pulse 2s ease-in-out infinite;
        }

        .thinking-title {
            font-size: var(--text-4xl);
            font-weight: var(--font-bold);
            color: white;
            margin-bottom: var(--space-2);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .thinking-subtitle {
            font-size: var(--text-lg);
            color: rgba(255, 255, 255, 0.9);
            font-weight: var(--font-medium);
            text-shadow: 0 1px 5px rgba(0, 0, 0, 0.2);
        }

        .skeleton-cards {
            max-width: 800px;
            width: 100%;
            padding: 0 var(--space-4);
            opacity: 0;
            animation: fadeInUp 1s ease-out 0.5s forwards;
        }

        .skeleton-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-2xl);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: var(--space-6);
            margin-bottom: var(--space-4);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .skeleton-header {
            display: flex;
            align-items: center;
            margin-bottom: var(--space-4);
        }

        .skeleton-icon {
            width: 24px;
            height: 24px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            margin-right: var(--space-3);
            animation: shimmer 2s ease-in-out infinite;
        }

        .skeleton-title {
            height: 20px;
            width: 200px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-md);
            animation: shimmer 2s ease-in-out infinite;
        }

        .skeleton-content {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
        }

        .skeleton-line {
            height: 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-md);
            animation: shimmer 2s ease-in-out infinite;
        }

        .skeleton-line:nth-child(1) { width: 100%; }
        .skeleton-line:nth-child(2) { width: 80%; }
        .skeleton-line:nth-child(3) { width: 60%; }

        .progress-indicator {
            margin-top: var(--space-6);
            text-align: center;
            padding: var(--space-4);
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            backdrop-filter: blur(10px);
        }

        .progress-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: var(--text-sm);
            margin-bottom: var(--space-2);
        }

        .progress-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, white, rgba(255, 255, 255, 0.8));
            border-radius: 2px;
            width: 0%;
            transition: width 0.8s ease-out;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            right: 0;
            top: 0;
            width: 20px;
            height: 100%;
            background: linear-gradient(90deg, transparent, white);
            animation: shimmer 2s ease-in-out infinite;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }

        @keyframes shimmer {
            0%, 100% {
                opacity: 0.3;
            }
            50% {
                opacity: 0.7;
            }
        }

        /* é”™è¯¯çŠ¶æ€æ ·å¼ */
        .error-container {
            padding-top: 80px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .error-icon {
            font-size: 4rem;
            color: #ff6b6b;
            margin-bottom: var(--space-4);
        }

        .error-title {
            font-size: var(--text-3xl);
            font-weight: var(--font-bold);
            color: white;
            margin-bottom: var(--space-2);
        }

        .error-message {
            font-size: var(--text-lg);
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: var(--space-6);
            max-width: 500px;
        }

        .retry-btn {
            padding: var(--space-3) var(--space-6);
            background: var(--color-primary);
            color: white;
            text-decoration: none;
            border-radius: var(--radius-lg);
            font-weight: var(--font-medium);
            transition: all 0.3s ease;
        }

        .retry-btn:hover {
            background: var(--color-primary-dark);
            color: white;
            text-decoration: none;
            transform: translateY(-2px);
        }

        @media (max-width: 640px) {
            .share-modal {
                min-width: 0;
                width: 90%;
                padding: var(--space-6);
            }
            
            .social-buttons {
                grid-template-columns: repeat(2, 1fr);
            }

            .skeleton-cards {
                padding: 0 var(--space-2);
            }

            .thinking-title {
                font-size: var(--text-2xl);
            }
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="navbar-left">
            <a href="/" class="back-btn">
                <i class="fas fa-arrow-left"></i>
                <span>é‡æ–°è®¾è®¡æ–¹æ¡ˆ</span>
            </a>
            <a href="/" class="navbar-brand">Angela AI</a>
        </div>
        <div class="navbar-right">
            <a href="/admin" class="navbar-action">
                <i class="fas fa-cog me-1"></i>
                ç®¡ç†åå°
            </a>
        </div>
    </nav>

    {% if status == 'loading' %}
    <!-- åŠ è½½çŠ¶æ€ï¼šæ˜¾ç¤ºéª¨æ¶å± -->
    <div class="skeleton-container">
        <div class="thinking-header">
            <div class="ai-icon">
                <i class="fas fa-brain"></i>
            </div>
            <h1 class="thinking-title">Angela AIæ­£åœ¨ä¸ºæ‚¨å®šåˆ¶æ–¹æ¡ˆ</h1>
            <p class="thinking-subtitle">æ­£åœ¨æ·±åº¦åˆ†ææ‚¨çš„é¡¹ç›®ä¿¡æ¯ï¼Œç”Ÿæˆä¸ªæ€§åŒ–æ”¶å…¥è·¯å¾„æ–¹æ¡ˆ...</p>
        </div>

        <div class="skeleton-cards">
            <!-- é¡¹ç›®æ¦‚è§ˆéª¨æ¶ -->
            <div class="skeleton-card">
                <div class="skeleton-header">
                    <div class="skeleton-icon"></div>
                    <div class="skeleton-title"></div>
                </div>
                <div class="skeleton-content">
                    <div class="skeleton-line"></div>
                    <div class="skeleton-line"></div>
                    <div class="skeleton-line"></div>
                </div>
            </div>

            <!-- è·¯å¾„æ–¹æ¡ˆéª¨æ¶ -->
            <div class="skeleton-card">
                <div class="skeleton-header">
                    <div class="skeleton-icon"></div>
                    <div class="skeleton-title"></div>
                </div>
                <div class="skeleton-content">
                    <div class="skeleton-line"></div>
                    <div class="skeleton-line"></div>
                    <div class="skeleton-line"></div>
                </div>
            </div>

            <div class="skeleton-card">
                <div class="skeleton-header">
                    <div class="skeleton-icon"></div>
                    <div class="skeleton-title"></div>
                </div>
                <div class="skeleton-content">
                    <div class="skeleton-line"></div>
                    <div class="skeleton-line"></div>
                    <div class="skeleton-line"></div>
                </div>
            </div>

            <!-- è¿›åº¦æŒ‡ç¤ºå™¨ -->
            <div class="progress-indicator">
                <div class="progress-text" id="progressText">Angela AIæ­£åœ¨æ™ºèƒ½åˆ†æä¸­...</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
        </div>
    </div>

    {% elif status == 'error' %}
    <!-- é”™è¯¯çŠ¶æ€ -->
    <div class="error-container">
        <div class="error-icon">
            <i class="fas fa-exclamation-triangle"></i>
        </div>
        <h1 class="error-title">åˆ†æé‡åˆ°é—®é¢˜</h1>
        <p class="error-message">{{ error_message or 'åˆ†æè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•' }}</p>
        <a href="/" class="retry-btn">
            <i class="fas fa-redo me-2"></i>
            é‡æ–°å¼€å§‹
        </a>
    </div>

    {% else %}
    <!-- å®ŒæˆçŠ¶æ€ï¼šæ˜¾ç¤ºå®Œæ•´ç»“æœ -->

    <div class="result-page-container">
        <!-- é¡µé¢å¤´éƒ¨ -->
        <div class="result-hero fade-in-up">
            <div class="hero-badge">
                <i class="fas fa-magic me-2"></i>
                AIæ™ºèƒ½åˆ†æå®Œæˆ
            </div>
            <h1 class="hero-title">éåŠ³åŠ¡æ”¶å…¥è·¯å¾„è®¾è®¡æ–¹æ¡ˆ</h1>
            <p class="hero-subtitle">åŸºäºæ‚¨æä¾›çš„é¡¹ç›®ä¿¡æ¯å’Œå…³é”®äººç‰©èµ„æºï¼Œæˆ‘ä»¬ä¸ºæ‚¨ç”Ÿæˆäº†ä¸“ä¸šçš„æ”¶å…¥ç®¡é“è®¾è®¡æ–¹æ¡ˆ</p>
        </div>

        <!-- æ¦‚è§ˆå¡ç‰‡ -->
        <div class="glass-card overview-card fade-in-up animate-delay-1">
            <h2 class="overview-title">
                <i class="fas fa-chart-line"></i>
                é¡¹ç›®æ¦‚è§ˆä¸åˆ†æ
            </h2>
            <div class="situation-text">
                {{ result.overview.situation if result and result.overview else "å½“å‰å·²æŒæ¡èµ„æºé›†ä¸­åœ¨å…³é”®äººç‰©çš„æ¸ é“å’Œå½±å“åŠ›ï¼Œéœ€è¦è¿›ä¸€æ­¥æ•´åˆå˜ç°è·¯å¾„ã€‚" }}
            </div>
            
            {% if result and result.overview and result.overview.gaps %}
            <div class="gaps-container">
                <div class="gaps-title">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    éœ€è¦è¡¥é½çš„å…³é”®ç¯èŠ‚
                </div>
                <div class="gap-tags">
                    {% for gap in result.overview.gaps %}
                    <span class="gap-tag">{{ gap }}</span>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>

        <!-- è·¯å¾„æ–¹æ¡ˆ -->
        {% if result and result.paths %}
        {% for path in result.paths %}
        <div class="glass-card path-card fade-in-up animate-delay-{{ loop.index + 1 }}">
            <div class="path-header">
                <div style="display: flex; align-items: center;">
                    <div class="path-number">{{ loop.index }}</div>
                    <h3 class="path-title">{{ path.name }}</h3>
                </div>
                <div class="path-scene">
                    <i class="fas fa-map-marker-alt me-2"></i>
                    {{ path.scene }}
                </div>
            </div>

            <!-- æ‰§è¡Œé¡ºåº -->
            <div style="margin-bottom: var(--space-6);">
                <div style="display: flex; align-items: center; margin-bottom: var(--space-3);">
                    <i class="fas fa-play-circle" style="color: var(--color-primary); margin-right: var(--space-2);"></i>
                    <strong>å¯åŠ¨ç­–ç•¥ï¼š</strong>
                </div>
                <div style="color: var(--color-text-secondary); font-size: var(--text-lg);">
                    {{ path.who_moves_first }}
                </div>
            </div>

            <!-- è¡ŒåŠ¨æ­¥éª¤ -->
            <div class="action-steps">
                <h4 style="display: flex; align-items: center; margin-bottom: var(--space-4);">
                    <i class="fas fa-list-ol me-2"></i>
                    æ‰§è¡Œæ­¥éª¤
                </h4>
                {% for step in path.action_steps %}
                <div class="step-item">
                    <div class="step-owner">{{ step.owner }}</div>
                    <div class="step-content">
                        <div class="step-action">{{ step.step }}</div>
                        <div class="step-reason">ğŸ’¡ {{ step.why_it_works }}</div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- MVPéªŒè¯ -->
            {% if path.mvp %}
            <div class="mvp-section">
                <div class="mvp-title">
                    <i class="fas fa-rocket"></i>
                    æœ€å°å¯éªŒè¯åŸå‹ (MVP)
                </div>
                <div>{{ path.mvp }}</div>
            </div>
            {% endif %}

            <!-- èµ„æºä½¿ç”¨å’Œé£é™©ç®¡ç† -->
            <div class="resources-risks">
                <div class="info-section">
                    <div class="info-title">
                        <i class="fas fa-users me-2"></i>
                        å…³é”®äººç‰©èµ„æº
                    </div>
                    <ul class="info-list">
                        {% for resource in path.use_key_person_resources %}
                        <li>{{ resource }}</li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="info-section">
                    <div class="info-title">
                        <i class="fas fa-shield-alt me-2"></i>
                        é£é™©ä¸åº”å¯¹
                    </div>
                    <ul class="info-list">
                        {% for risk in path.risks %}
                        <li>{{ risk }}</li>
                        {% endfor %}
                        {% if path.plan_b %}
                        <li><strong>å¤‡é€‰æ–¹æ¡ˆï¼š</strong>{{ path.plan_b }}</li>
                        {% endif %}
                    </ul>
                </div>
            </div>

            <!-- æ”¶ç›Šè§¦å‘ç‚¹ -->
            {% if path.revenue_trigger %}
            <div style="background: linear-gradient(135deg, var(--color-accent), #ff7043); color: white; padding: var(--space-4); border-radius: var(--radius-lg); margin-top: var(--space-4);">
                <div style="display: flex; align-items: center; font-weight: var(--font-semibold);">
                    <i class="fas fa-coins me-2"></i>
                    æ”¶ç›Šè§¦å‘ç‚¹
                </div>
                <div style="margin-top: var(--space-2);">{{ path.revenue_trigger }}</div>
            </div>
            {% endif %}
        </div>
        {% endfor %}
        {% else %}
        <!-- ç¤ºä¾‹æ•°æ®å±•ç¤º -->
        <div class="glass-card path-card fade-in-up animate-delay-2">
            <div class="path-header">
                <div style="display: flex; align-items: center;">
                    <div class="path-number">1</div>
                    <h3 class="path-title">è§†é¢‘å·å¸¦è´§åˆ†æˆ</h3>
                </div>
                <div class="path-scene">
                    <i class="fas fa-map-marker-alt me-2"></i>
                    é€šè¿‡å¼ ä¸‰çš„è§†é¢‘å·è¿›è¡Œå•†å“æ¨å¹¿
                </div>
            </div>

            <div style="margin-bottom: var(--space-6);">
                <div style="display: flex; align-items: center; margin-bottom: var(--space-3);">
                    <i class="fas fa-play-circle" style="color: var(--color-primary); margin-right: var(--space-2);"></i>
                    <strong>å¯åŠ¨ç­–ç•¥ï¼š</strong>
                </div>
                <div style="color: var(--color-text-secondary); font-size: var(--text-lg);">
                    ä½ å…ˆä¸å¼ ä¸‰å¯¹æ¥åˆ†æˆæ¨¡å¼
                </div>
            </div>

            <div class="action-steps">
                <h4 style="display: flex; align-items: center; margin-bottom: var(--space-4);">
                    <i class="fas fa-list-ol me-2"></i>
                    æ‰§è¡Œæ­¥éª¤
                </h4>
                <div class="step-item">
                    <div class="step-owner">ä½ </div>
                    <div class="step-content">
                        <div class="step-action">è”ç³»å¼ ä¸‰ï¼Œå•†è®¨è§†é¢‘å·æ¨å¹¿åˆ†æˆæ¨¡å¼ï¼Œç¡®å®šå•†å“ç±»å‹å’Œåˆ†æˆæ¯”ä¾‹</div>
                        <div class="step-reason">ğŸ’¡ å¼ ä¸‰èµ„æºé›†ä¸­åœ¨è§†é¢‘å·ï¼Œåˆ†æˆæ»¡è¶³å…¶ç»æµåŠ¨æœº</div>
                    </div>
                </div>
                <div class="step-item">
                    <div class="step-owner">å¼ ä¸‰</div>
                    <div class="step-content">
                        <div class="step-action">å‘å¸ƒå¸¦è´§è§†é¢‘å†…å®¹ï¼ˆæ¯å‘¨2æ¡ï¼‰ï¼Œå¹¶åœ¨è§†é¢‘ä¸­é™„å¸¦å•†å“è´­ä¹°é“¾æ¥</div>
                        <div class="step-reason">ğŸ’¡ åˆ©ç”¨è§†é¢‘å·ç²‰ä¸è¿›è¡Œç²¾å‡†æ¨å¹¿ï¼Œç›´æ¥è§¦å‘è½¬åŒ–</div>
                    </div>
                </div>
                <div class="step-item">
                    <div class="step-owner">ä½ </div>
                    <div class="step-content">
                        <div class="step-action">é€šè¿‡ç”µå•†å¹³å°è”ç³»å°å•†å®¶ï¼Œè·å–è¯•ç”¨å“æˆ–æ ·å“ä»¥å¤‡æ¨å¹¿</div>
                        <div class="step-reason">ğŸ’¡ è¡¥å……å…·ä½“å¯æ¨å¹¿çš„äº§å“èµ„æºï¼Œé™ä½å¯åŠ¨é—¨æ§›</div>
                    </div>
                </div>
            </div>

            <div class="mvp-section">
                <div class="mvp-title">
                    <i class="fas fa-rocket"></i>
                    æœ€å°å¯éªŒè¯åŸå‹ (MVP)
                </div>
                <div>è”ç³»3ä¸ªå•†å®¶ï¼ŒæˆåŠŸå®Œæˆè‡³å°‘1ä¸ªå•†å“æ¨å¹¿è§†é¢‘å¹¶è·å¾—é¦–æ‰¹è®¢å•ï¼ˆç›®æ ‡â‰¥10å•ï¼‰</div>
            </div>

            <div class="resources-risks">
                <div class="info-section">
                    <div class="info-title">
                        <i class="fas fa-users me-2"></i>
                        å…³é”®äººç‰©èµ„æº
                    </div>
                    <ul class="info-list">
                        <li>å¼ ä¸‰çš„è§†é¢‘å·ç²‰ä¸5ä¸‡</li>
                        <li>å¼ ä¸‰çš„3ä¸ªå¾®ä¿¡ç¾¤</li>
                    </ul>
                </div>
                <div class="info-section">
                    <div class="info-title">
                        <i class="fas fa-shield-alt me-2"></i>
                        é£é™©ä¸åº”å¯¹
                    </div>
                    <ul class="info-list">
                        <li>å•†å“è´¨é‡ä¸ä½³å¯¼è‡´è´Ÿé¢è¯„ä»·</li>
                        <li>è§†é¢‘å·å¸¦è´§æ•ˆæœä¸ç†æƒ³</li>
                        <li><strong>å¤‡é€‰æ–¹æ¡ˆï¼š</strong>è‹¥å•†å“æ•ˆæœä¸ä½³ï¼Œæ”¹ä¸ºæ¨å¹¿è™šæ‹Ÿå•†å“æˆ–æœåŠ¡ï¼Œå¦‚è¯¾ç¨‹æˆ–ä¼šå‘˜å¡</li>
                    </ul>
                </div>
            </div>

            <div style="background: linear-gradient(135deg, var(--color-accent), #ff7043); color: white; padding: var(--space-4); border-radius: var(--radius-lg); margin-top: var(--space-4);">
                <div style="display: flex; align-items: center; font-weight: var(--font-semibold);">
                    <i class="fas fa-coins me-2"></i>
                    æ”¶ç›Šè§¦å‘ç‚¹
                </div>
                <div style="margin-top: var(--space-2);">é€šè¿‡è§†é¢‘å·å¸¦è´§äº§ç”Ÿé”€å”®åˆ†æˆ</div>
            </div>
        </div>
        {% endif %}

        <!-- æ“ä½œæŒ‰é’® -->
        <div class="action-buttons fade-in-up animate-delay-4">
            <button class="action-btn btn-primary-custom" onclick="exportToPDF()">
                <i class="fas fa-download"></i>
                å¯¼å‡ºPDFæŠ¥å‘Š
            </button>
            <button class="action-btn btn-secondary-custom" onclick="shareResult()">
                <i class="fas fa-share-alt"></i>
                åˆ†äº«æ–¹æ¡ˆ
            </button>
        </div>
    </div>

    <!-- åˆ†äº«æ¨¡æ€æ¡† -->
    <div class="share-overlay" id="shareOverlay" onclick="hideShareModal()"></div>
    <div class="share-modal" id="shareModal">
        <div class="share-header">
            <h3 class="share-title">åˆ†äº«æ–¹æ¡ˆ</h3>
            <button class="close-btn" onclick="hideShareModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="share-options">
            <!-- å¤åˆ¶é“¾æ¥ -->
            <div class="share-section">
                <div class="section-title">
                    <i class="fas fa-link me-2"></i>
                    å¤åˆ¶é“¾æ¥
                </div>
                <div class="copy-link-section">
                    <button class="copy-link-btn" onclick="copyShareLink()">
                        <i class="fas fa-copy me-2"></i>
                        å¤åˆ¶é“¾æ¥åˆ°å‰ªè´´æ¿
                    </button>
                </div>
            </div>

            <!-- ç¤¾äº¤åª’ä½“åˆ†äº« -->
            <div class="share-section">
                <div class="section-title">
                    <i class="fas fa-share-alt me-2"></i>
                    ç¤¾äº¤åª’ä½“åˆ†äº«
                </div>
                <div class="social-buttons">
                    <div class="social-btn" onclick="shareToSocial('wechat')">
                        <div class="social-icon wechat">
                            <i class="fab fa-weixin"></i>
                        </div>
                        <span>å¾®ä¿¡</span>
                    </div>
                    <div class="social-btn" onclick="shareToSocial('weibo')">
                        <div class="social-icon weibo">
                            <i class="fab fa-weibo"></i>
                        </div>
                        <span>å¾®åš</span>
                    </div>
                    <div class="social-btn" onclick="shareToSocial('qq')">
                        <div class="social-icon qq">
                            <i class="fab fa-qq"></i>
                        </div>
                        <span>QQ</span>
                    </div>
                    <div class="social-btn" onclick="shareToSocial('qzone')">
                        <div class="social-icon qzone">
                            <i class="fas fa-star"></i>
                        </div>
                        <span>QQç©ºé—´</span>
                    </div>
                </div>
                
                <!-- å¾®ä¿¡äºŒç»´ç åŒºåŸŸ -->
                <div class="wechat-qr" id="wechatQR"></div>
            </div>
        </div>
    </div>

    {% endif %}

    <!-- JavaScript -->
    <script>
        // çŠ¶æ€è½®è¯¢åŠŸèƒ½ - ä»…åœ¨åŠ è½½çŠ¶æ€æ—¶è¿è¡Œ
        {% if status == 'loading' %}
        let pollAttempts = 0;
        let maxPollAttempts = 60; // æœ€å¤šè½®è¯¢5åˆ†é’Ÿï¼ˆæ¯5ç§’ä¸€æ¬¡ï¼‰
        let progressValue = 10;

        function pollAnalysisStatus() {
            pollAttempts++;
            
            // æ›´æ–°è¿›åº¦æ¡å’Œæ–‡æœ¬
            updateProgressDisplay();
            
            console.log(`Polling analysis status, attempt: ${pollAttempts}`);
            
            fetch('/check_analysis_status')
                .then(response => response.json())
                .then(data => {
                    console.log('Analysis status response:', data);
                    
                    if (data.status === 'completed') {
                        // åˆ†æå®Œæˆï¼Œåˆ·æ–°é¡µé¢æ˜¾ç¤ºç»“æœ
                        updateProgress(100, 'åˆ†æå®Œæˆï¼æ­£åœ¨åŠ è½½ç»“æœ...');
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    } else if (data.status === 'error') {
                        // åˆ†æå‡ºé”™ï¼Œæ˜¾ç¤ºé”™è¯¯å¹¶åœæ­¢è½®è¯¢
                        updateProgress(0, 'åˆ†æé‡åˆ°é”™è¯¯ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                        console.error('Analysis error:', data.message);
                        setTimeout(() => {
                            window.location.reload();
                        }, 3000);
                    } else if (pollAttempts >= maxPollAttempts) {
                        // è¶…æ—¶ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                        updateProgress(0, 'åˆ†æè¶…æ—¶ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                        setTimeout(() => {
                            window.location.reload();
                        }, 3000);
                    } else {
                        // ç»§ç»­è½®è¯¢
                        setTimeout(pollAnalysisStatus, 3000); // 3ç§’åå†æ¬¡æ£€æŸ¥
                    }
                })
                .catch(error => {
                    console.error('Analysis status check failed:', error);
                    if (pollAttempts >= maxPollAttempts) {
                        updateProgress(0, 'ç½‘ç»œé”™è¯¯ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                        setTimeout(() => {
                            window.location.reload();
                        }, 3000);
                    } else {
                        setTimeout(pollAnalysisStatus, 5000); // å‡ºé”™æ—¶5ç§’åé‡è¯•
                    }
                });
        }

        function updateProgressDisplay() {
            const progressMessages = [
                'æ­£åœ¨æ”¶é›†é¡¹ç›®ä¿¡æ¯...',
                'æ­£åœ¨åˆ†æå…³é”®äººç‰©èµ„æº...',
                'æ­£åœ¨æŸ¥è¯¢çŸ¥è¯†åº“...',
                'æ­£åœ¨ç”Ÿæˆæ”¶å…¥è·¯å¾„...',
                'æ­£åœ¨åˆ¶å®šæ‰§è¡Œæ–¹æ¡ˆ...',
                'æ­£åœ¨æ•´åˆåˆ†æç»“æœ...'
            ];
            
            // æ ¹æ®è½®è¯¢æ¬¡æ•°æ›´æ–°è¿›åº¦
            const messageIndex = Math.min(Math.floor(pollAttempts / 3), progressMessages.length - 1);
            const message = progressMessages[messageIndex];
            
            // è®¡ç®—è¿›åº¦ç™¾åˆ†æ¯”ï¼ˆæœ€å¤§90%ï¼Œç•™10%ç»™æœ€ç»ˆå®Œæˆï¼‰
            progressValue = Math.min(10 + (pollAttempts * 3), 90);
            
            updateProgress(progressValue, message);
        }

        function updateProgress(percent, message) {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            if (progressFill) {
                progressFill.style.width = percent + '%';
            }
            
            if (progressText) {
                progressText.textContent = message;
            }
        }

        // å¯åŠ¨è½®è¯¢
        document.addEventListener('DOMContentLoaded', function() {
            // ç«‹å³å¼€å§‹ç¬¬ä¸€æ¬¡è½®è¯¢
            setTimeout(pollAnalysisStatus, 1000);
        });
        {% endif %}
        function exportToPDF() {
            // æ˜¾ç¤ºå¯¼å‡ºè¿›åº¦
            const exportBtn = document.querySelector('.action-btn.btn-primary-custom');
            const originalText = exportBtn.innerHTML;
            exportBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>æ­£åœ¨ç”ŸæˆPDF...';
            exportBtn.disabled = true;

            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF('p', 'mm', 'a4');
                
                // è®¾ç½®å­—ä½“å’ŒåŸºæœ¬æ ·å¼
                doc.setFont('helvetica');
                
                let yPos = 20;
                const pageWidth = 210; // A4å®½åº¦
                const margin = 20;
                const contentWidth = pageWidth - 2 * margin;
                
                // æ ‡é¢˜
                doc.setFontSize(24);
                doc.setTextColor(0, 122, 255); // iOSè“è‰²
                doc.text('Angela AI - éåŠ³åŠ¡æ”¶å…¥è·¯å¾„è®¾è®¡æ–¹æ¡ˆ', margin, yPos);
                yPos += 15;
                
                // å‰¯æ ‡é¢˜
                doc.setFontSize(14);
                doc.setTextColor(109, 109, 112); // ç°è‰²
                doc.text('åŸºäºAIæ™ºèƒ½åˆ†æç”Ÿæˆçš„ä¸ªæ€§åŒ–æ”¶å…¥ç®¡é“è®¾è®¡', margin, yPos);
                yPos += 20;
                
                // ç”Ÿæˆæ—¶é—´
                doc.setFontSize(10);
                doc.setTextColor(174, 174, 178);
                const currentDate = new Date().toLocaleString('zh-CN');
                doc.text(`ç”Ÿæˆæ—¶é—´: ${currentDate}`, margin, yPos);
                yPos += 15;
                
                // åˆ†å‰²çº¿
                doc.setDrawColor(229, 229, 234);
                doc.line(margin, yPos, pageWidth - margin, yPos);
                yPos += 10;
                
                // é¡¹ç›®æ¦‚è§ˆ
                doc.setFontSize(16);
                doc.setTextColor(0, 0, 0);
                doc.text('é¡¹ç›®æ¦‚è§ˆä¸åˆ†æ', margin, yPos);
                yPos += 10;
                
                doc.setFontSize(12);
                doc.setTextColor(60, 60, 60);
                
                // è·å–æ¦‚è§ˆå†…å®¹
                const overviewText = document.querySelector('.situation-text')?.textContent || 'å½“å‰å·²æŒæ¡èµ„æºé›†ä¸­åœ¨å…³é”®äººç‰©çš„æ¸ é“å’Œå½±å“åŠ›ï¼Œéœ€è¦è¿›ä¸€æ­¥æ•´åˆå˜ç°è·¯å¾„ã€‚';
                const splitText = doc.splitTextToSize(overviewText, contentWidth);
                doc.text(splitText, margin, yPos);
                yPos += splitText.length * 6 + 10;
                
                // éœ€è¦è¡¥é½çš„å…³é”®ç¯èŠ‚
                const gapTags = document.querySelectorAll('.gap-tag');
                if (gapTags.length > 0) {
                    doc.setFontSize(14);
                    doc.setTextColor(255, 59, 48); // çº¢è‰²
                    doc.text('éœ€è¦è¡¥é½çš„å…³é”®ç¯èŠ‚:', margin, yPos);
                    yPos += 8;
                    
                    doc.setFontSize(11);
                    doc.setTextColor(80, 80, 80);
                    gapTags.forEach((tag, index) => {
                        doc.text(`â€¢ ${tag.textContent}`, margin + 5, yPos);
                        yPos += 6;
                    });
                    yPos += 10;
                }
                
                // æ”¶å…¥è·¯å¾„æ–¹æ¡ˆ
                const pathCards = document.querySelectorAll('.path-card');
                pathCards.forEach((card, index) => {
                    // æ£€æŸ¥æ˜¯å¦éœ€è¦æ–°é¡µé¢
                    if (yPos > 250) {
                        doc.addPage();
                        yPos = 20;
                    }
                    
                    // è·¯å¾„æ ‡é¢˜
                    doc.setFontSize(16);
                    doc.setTextColor(0, 122, 255);
                    const pathTitle = card.querySelector('.path-title')?.textContent || `è·¯å¾„æ–¹æ¡ˆ ${index + 1}`;
                    doc.text(`${index + 1}. ${pathTitle}`, margin, yPos);
                    yPos += 10;
                    
                    // åœºæ™¯æè¿°
                    doc.setFontSize(12);
                    doc.setTextColor(109, 109, 112);
                    const pathScene = card.querySelector('.path-scene')?.textContent || '';
                    if (pathScene) {
                        doc.text(`åœºæ™¯: ${pathScene}`, margin, yPos);
                        yPos += 8;
                    }
                    
                    // å¯åŠ¨ç­–ç•¥
                    doc.setFontSize(11);
                    doc.setTextColor(0, 0, 0);
                    const whoMovesFirst = card.querySelector('div[style*="color: var(--color-text-secondary)"]')?.textContent || '';
                    if (whoMovesFirst) {
                        doc.text(`å¯åŠ¨ç­–ç•¥: ${whoMovesFirst}`, margin, yPos);
                        yPos += 8;
                    }
                    
                    // æ‰§è¡Œæ­¥éª¤
                    doc.setFontSize(12);
                    doc.setTextColor(0, 0, 0);
                    doc.text('æ‰§è¡Œæ­¥éª¤:', margin, yPos);
                    yPos += 6;
                    
                    const stepItems = card.querySelectorAll('.step-item');
                    stepItems.forEach((step, stepIndex) => {
                        const owner = step.querySelector('.step-owner')?.textContent || '';
                        const action = step.querySelector('.step-action')?.textContent || '';
                        const reason = step.querySelector('.step-reason')?.textContent || '';
                        
                        doc.setFontSize(10);
                        doc.setTextColor(0, 122, 255);
                        doc.text(`${stepIndex + 1}. ${owner}:`, margin + 5, yPos);
                        yPos += 5;
                        
                        doc.setFontSize(10);
                        doc.setTextColor(60, 60, 60);
                        const actionText = doc.splitTextToSize(action, contentWidth - 10);
                        doc.text(actionText, margin + 10, yPos);
                        yPos += actionText.length * 4;
                        
                        if (reason) {
                            doc.setFontSize(9);
                            doc.setTextColor(109, 109, 112);
                            const reasonText = doc.splitTextToSize(reason, contentWidth - 10);
                            doc.text(reasonText, margin + 10, yPos);
                            yPos += reasonText.length * 3 + 3;
                        }
                    });
                    
                    // MVPéªŒè¯
                    const mvpSection = card.querySelector('.mvp-section');
                    if (mvpSection) {
                        yPos += 5;
                        doc.setFontSize(12);
                        doc.setTextColor(52, 199, 89); // ç»¿è‰²
                        doc.text('æœ€å°å¯éªŒè¯åŸå‹ (MVP):', margin, yPos);
                        yPos += 6;
                        
                        doc.setFontSize(10);
                        doc.setTextColor(60, 60, 60);
                        const mvpText = mvpSection.textContent.replace('æœ€å°å¯éªŒè¯åŸå‹ (MVP)', '').trim();
                        const mvpLines = doc.splitTextToSize(mvpText, contentWidth - 5);
                        doc.text(mvpLines, margin + 5, yPos);
                        yPos += mvpLines.length * 4 + 5;
                    }
                    
                    // èµ„æºå’Œé£é™©
                    const resourcesSection = card.querySelector('.info-section .info-title');
                    if (resourcesSection && resourcesSection.textContent.includes('å…³é”®äººç‰©èµ„æº')) {
                        doc.setFontSize(11);
                        doc.setTextColor(0, 0, 0);
                        doc.text('å…³é”®äººç‰©èµ„æº:', margin, yPos);
                        yPos += 5;
                        
                        const resourceItems = card.querySelectorAll('.info-section .info-list li');
                        resourceItems.forEach(item => {
                            doc.setFontSize(9);
                            doc.setTextColor(80, 80, 80);
                            doc.text(`â€¢ ${item.textContent}`, margin + 5, yPos);
                            yPos += 4;
                        });
                        yPos += 5;
                    }
                    
                    yPos += 15; // è·¯å¾„é—´è·
                });
                
                // é¡µè„š
                const pageCount = doc.internal.getNumberOfPages();
                for (let i = 1; i <= pageCount; i++) {
                    doc.setPage(i);
                    doc.setFontSize(8);
                    doc.setTextColor(174, 174, 178);
                    doc.text(`Angela AI æ”¶å…¥è·¯å¾„è®¾è®¡æ–¹æ¡ˆ - ç¬¬ ${i} é¡µï¼Œå…± ${pageCount} é¡µ`, margin, 287);
                    doc.text(`ç”Ÿæˆæ—¶é—´: ${currentDate}`, pageWidth - margin - 60, 287);
                }
                
                // ä¿å­˜PDF
                const fileName = `Angela_AI_æ”¶å…¥è·¯å¾„æ–¹æ¡ˆ_${new Date().toISOString().split('T')[0]}.pdf`;
                doc.save(fileName);
                
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                setTimeout(() => {
                    exportBtn.innerHTML = originalText;
                    exportBtn.disabled = false;
                }, 1000);
                
            } catch (error) {
                console.error('PDFå¯¼å‡ºå¤±è´¥:', error);
                alert('PDFå¯¼å‡ºå¤±è´¥ï¼Œè¯·é‡è¯•');
                exportBtn.innerHTML = originalText;
                exportBtn.disabled = false;
            }
        }

        function shareResult() {
            showShareModal();
        }

        function showShareModal() {
            const modal = document.getElementById('shareModal');
            const overlay = document.getElementById('shareOverlay');
            modal.style.display = 'block';
            overlay.style.display = 'block';
            setTimeout(() => {
                modal.classList.add('show');
                overlay.classList.add('show');
            }, 10);
        }

        function hideShareModal() {
            const modal = document.getElementById('shareModal');
            const overlay = document.getElementById('shareOverlay');
            modal.classList.remove('show');
            overlay.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
                overlay.style.display = 'none';
            }, 300);
        }

        function copyShareLink() {
            const shareUrl = window.location.href;
            navigator.clipboard.writeText(shareUrl).then(() => {
                const copyBtn = document.querySelector('.copy-link-btn');
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '<i class="fas fa-check me-2"></i>å·²å¤åˆ¶';
                copyBtn.style.background = 'var(--color-success)';
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                    copyBtn.style.background = '';
                }, 2000);
            });
        }

        function shareToSocial(platform) {
            const shareUrl = encodeURIComponent(window.location.href);
            const shareTitle = encodeURIComponent('Angela AI - æˆ‘çš„éåŠ³åŠ¡æ”¶å…¥è®¾è®¡æ–¹æ¡ˆ');
            const shareText = encodeURIComponent('é€šè¿‡AIæ™ºèƒ½åˆ†æç”Ÿæˆçš„ä¸ªæ€§åŒ–æ”¶å…¥è·¯å¾„æ–¹æ¡ˆ');
            
            let url = '';
            switch(platform) {
                case 'wechat':
                    // å¾®ä¿¡åˆ†äº«éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œæ˜¾ç¤ºäºŒç»´ç 
                    showWechatQR();
                    return;
                case 'weibo':
                    url = `https://service.weibo.com/share/share.php?url=${shareUrl}&title=${shareText}&pic=`;
                    break;
                case 'qq':
                    url = `https://connect.qq.com/widget/shareqq/index.html?url=${shareUrl}&title=${shareTitle}&summary=${shareText}`;
                    break;
                case 'qzone':
                    url = `https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=${shareUrl}&title=${shareTitle}&summary=${shareText}`;
                    break;
            }
            
            if (url) {
                window.open(url, '_blank', 'width=600,height=400');
            }
        }

        function showWechatQR() {
            const qrContainer = document.getElementById('wechatQR');
            const shareUrl = window.location.href;
            
            // ä½¿ç”¨å…è´¹çš„äºŒç»´ç APIç”ŸæˆäºŒç»´ç 
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(shareUrl)}`;
            
            qrContainer.innerHTML = `
                <div style="text-align: center; padding: var(--space-4);">
                    <img src="${qrUrl}" alt="äºŒç»´ç " style="width: 200px; height: 200px; border-radius: var(--radius-lg);">
                    <p style="margin-top: var(--space-3); color: var(--color-text-secondary);">
                        ä½¿ç”¨å¾®ä¿¡æ‰«æäºŒç»´ç åˆ†äº«
                    </p>
                </div>
            `;
            qrContainer.style.display = 'block';
        }

        // é¡µé¢åŠ è½½åŠ¨ç”»
        document.addEventListener('DOMContentLoaded', function() {
            const elements = document.querySelectorAll('.fade-in-up');
            elements.forEach((el, index) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(30px)';
                
                setTimeout(() => {
                    el.style.transition = 'all 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });
    </script>
</body>
</html>